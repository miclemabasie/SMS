{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secondary School Report Card</title>
    <style>
        @page {
            size: A4;
            margin: 10pt;
            border: 2px solid black;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }

        .header-row,
        .info-row {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 10px;
        }

        .header-row .column,
        .info-row .info-column {
            flex: 1;
            text-align: center;
        }

        .header-row .column:first-child,
        .info-row .info-column:first-child {
            text-align: left;
        }

        .header-row .column:last-child,
        .info-row .info-column:last-child {
            text-align: right;
        }

        .logo img {
            max-width: 100px;
            height: auto;
        }

        .report-title {
            text-align: center;
            margin: 20px 0;
            font-size: 18px;
            font-weight: bold;
        }

        .subject-table,
        .discipline-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .subject-table th,
        .subject-table td,
        .discipline-table th,
        .discipline-table td {
            border: 1px solid #000;
            padding: 8px;
            text-align: center;
        }

        .subject-table th,
        .discipline-table th {
            background-color: #f0f0f0;
        }

        .subject-table tfoot td:first-child,
        .subject-table tfoot td:last-child {
            width: 100px;
            /* Adjust the width as needed */
        }

        table {
            border-collapse: collapse;
            width: 100%;
            border: 1px solid black;
        }

        th,
        td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
            font-size: 12px;
            /* Adjust the font size as needed */
        }

        tr {
            height: 40px;
            /* Adjust the height of the rows here */
        }

        .extra-info {
            /* Optionally, you can set width or adjust other properties for .extra-info */
        }

        .discipline,
        .gradding {
            display: inline-block;
            /* Optionally, you can set width or adjust other properties for .discipline and .gradding */
        }

        .inline {
            display: inline-block;
        }

        .signatures {
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
        }

        .signatures div {
            flex: 1;
            text-align: center;
        }

        .signatures div:first-child {
            text-align: left;
        }

        .signatures div:last-child {
            text-align: right;
        }
    </style>
</head>

<body>

    <div class="report-card">

        <div class="header-row">
            <div class="column">
                <p>Republic Of Cameroon<br>Peace Work Fatherland</p>
            </div>
            <div class="column logo">
                <img src="{% static 'assets/img/logo-small.png' %}" alt="School Logo">
            </div>
            <div class="column">
                <p>School Name<br>School Address</p>
            </div>
        </div>

        <div class="report-title">
            First Term Progress Report
        </div>

        <div class="info-row">
            <div class="info-column">
                <p>Section:</p>
                <p>Specialty:</p>
                <p>Student's Name:</p>
                <p>Date of Birth:</p>
            </div>
            <div class="info-column">
                <p>Science</p>
                <p>Mathematics</p>
                <p>John Doe</p>
                <p>01/01/2000</p>
            </div>
            <div class="info-column">
                <p>Academic Year:</p>
                <p>Class:</p>
                <p>Repeater:</p>
                <p>Adm. Nr:</p>
            </div>
            <div class="info-column">
                <p>2023/2024</p>
                <p>Form 4</p>
                <p>No</p>
                <p>12345</p>
            </div>
        </div>

        <table class="subject-table">
            <thead>
                <tr>
                    <th>SUBJECT NAME</th>
                    <th>1st Seq</th>
                    <th>2nd Seq</th>
                    <th>AV./20</th>
                    <th>COEF</th>
                    <th>M X C</th>
                    <th>Teacher's Name</th>
                    <th>Teacher's Remark</th>
                    <th>Teacher's Signature</th>
                </tr>
            </thead>

            <tbody>
                <tr>
                    <td>Mathematics</td>
                    <td style="color: green;">15</td>
                    <td style="color: green;">14</td>
                    <td style="color: green;">14.5</td>
                    <td>4</td>
                    <td style="color: green;">58</td>
                    <td>Mr. Smith</td>
                    <td>Good progress</td>
                    <td>Signature</td>
                </tr>
                <tr>
                    <td>English</td>
                    <td style="color: green;">13</td>
                    <td style="color: green;">12</td>
                    <td style="color: green;">12.5</td>
                    <td>3</td>
                    <td style="color: green;">37.5</td>
                    <td>Ms. Johnson</td>
                    <td>Well done</td>
                    <td>Signature</td>
                </tr>
                <tr>
                    <td>History</td>
                    <td style="color: red;">9</td>
                    <td style="color: green;">11</td>
                    <td style="color: green;">10</td>
                    <td>2</td>
                    <td style="color: green;">20</td>
                    <td>Mr. Lee</td>
                    <td>Needs improvement</td>
                    <td>Signature</td>
                </tr>
                <tr>
                    <th>GRAND TOTAL:</th>
                    <th>37</th>
                    <th>37</th>
                    <th>37</th>
                    <th>9</th>
                    <th>115.5</th>
                    <th colspan="3">Good progress overall</th>
                </tr>
                <tr>
                    <th rowspan="2">SEQ. Avg.</th>
                    <th rowspan="2" style="color: green;">12.33</th>
                    <th rowspan="2" style="color: green;">12.33</th>
                    <th colspan="2">
                        <h1>Term 1:</h1>
                    </th>
                    <th style="color: green;">
                        <h1>12.33</h1>
                    </th>
                    <th>Class Avg.</th>
                    <th>12.5</th>
                    <th></th>
                </tr>
                <tr>
                    <th colspan="2">
                        <h1>CLASS POSITION:</h1>
                    </th>
                    <th>
                        <h1>No. 5 / 30</h1>
                    </th>
                    <th colspan="2"></th>
                </tr>

            </tbody>
            <tfoot>
                <tr>
                    <td colspan="6">CLASS LEVEL</td>
                    <td style="color: green;" colspan="3"><i>Good</i></td>
                </tr>
                <tr>
                    <td colspan="6">TOTAL ENROLLMENT:</td>
                    <td>30</td>
                    <td colspan="2"></td>
                </tr>

            </tfoot>
        </table>

        <div class="section-header">
            <i><u>Principal's Remarks</u></i>
        </div>

        <div class="signatures">
            <div class="inline class-master-signature">
                <b style="font-size: 16px;"><i><span>signature of the class master</span></i></b>
            </div>

            <div class="inline class-master-signature">
                <b style="font-size: 16px;"><i>signature of the principal</i></b>
            </div>
        </div>

    </div>

    <button id="generate-pdf-btn">Generate pdf</button>

</body>

</html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>

// Example of fetching data from Django backend
let surl = "{% url 'reports:gen' %}"
fetch(surl)
  .then(response => response.json())
  .then(data => {
    // Proceed to fill the HTML template with the fetched data
    fillReportCard(data);
  })
  .catch(error => console.error('Error fetching data:', error));

  function fillReportCard(data) {
    // Replace placeholders in the HTML template with data
    document.querySelector('.report-title').textContent = data.term + ' Progress Report';
    document.querySelector('.info-column:nth-child(1) p:nth-child(1)').textContent = 'Section: ' + data.section;
    // Continue filling other parts of the report card template
  }
  
  function generatePDF() {
    const pdf = new jsPDF();
    const reportCard = document.querySelector('.report-card');
  
    // Convert the report card element to a PDF
    pdf.html(reportCard, {
      callback: function (pdf) {
        pdf.save('report_card.pdf');
      },
      x: 10,
      y: 10
    });
  }
  
  // Assuming you have a button or trigger for generating PDF
document.getElementById('generate-pdf-btn').addEventListener('click', function() {
    let url = "{% url 'reports:gen' %}"
    fetch(url)
      .then(response => response.json())
      .then(data => {
        fillReportCard(data);
        generatePDF();
      })
      .catch(error => console.error('Error fetching data:', error));
  });
  
</script>